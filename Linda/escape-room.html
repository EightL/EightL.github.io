<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TSP testy 2.0</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ffeef5 0%, #fff6fa 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .game-container {
            background: #fffbe8;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(184,92,142,0.15);
            padding: 40px 30px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }
        .game-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #b85c8e;
            margin-bottom: 8px;
        }
        .game-subtitle {
            font-size: 1rem;
            color: #7a5c1b;
            margin-bottom: 30px;
            opacity: 0.8;
        }
        .room-container {
            background: #f7e6b3;
            border: 2px solid #e6cfa3;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            min-height: 300px;
            position: relative;
        }
        .room-description {
            font-size: 1.1rem;
            color: #7a5c1b;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        .puzzle-area {
            background: #fff;
            border: 2px solid #e6cfa3;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .puzzle-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #b85c8e;
            margin-bottom: 15px;
        }
        .puzzle-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            border: 2px solid #e6cfa3;
            border-radius: 8px;
            background: #fff;
            color: #7a5c1b;
            text-align: center;
            margin-bottom: 15px;
        }
        .puzzle-input:focus {
            outline: none;
            border-color: #b85c8e;
            box-shadow: 0 0 0 3px rgba(184,92,142,0.1);
        }
        .submit-btn {
            background: #f7b3d7;
            color: #7a2d55;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin: 10px 5px;
        }
        .submit-btn:hover {
            background: #f19bc8;
            transform: translateY(-1px);
        }
        .submit-btn:active {
            transform: translateY(0);
        }
        .hint-btn {
            background: #ffeec2;
            color: #7a5c1b;
            border: 2px solid #e6cfa3;
            padding: 8px 16px;
            font-size: 0.9rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin: 5px;
        }
        .hint-btn:hover {
            background: #f7e6b3;
        }
        .feedback {
            padding: 16px;
            border-radius: 12px;
            font-weight: 600;
            margin: 15px 0;
            display: none;
        }
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        .hint-text {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            font-size: 0.9rem;
            display: none;
        }
        .back-btn {
            background: none;
            border: 2px solid #b85c8e;
            color: #b85c8e;
            padding: 12px 24px;
            font-size: 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }
        .back-btn:hover {
            background: #b85c8e;
            color: white;
        }
        .completed-message {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #c3e6cb;
            margin-bottom: 20px;
            display: none;
        }
        .puzzle-step {
            display: none;
        }
        .puzzle-step.active {
            display: block;
        }
        .progress-indicator {
            font-size: 0.9rem;
            color: #b08a4a;
            margin-bottom: 15px;
            font-weight: 600;
        }
    </style>
</head>
<body>
<audio id="birthday-music" src="happy-birthday-155461.mp3" autoplay loop style="display:none"></audio>
<script>
// Try to play music immediately on page load
document.addEventListener('DOMContentLoaded', function() {
  var audio = document.getElementById('birthday-music');
  if (audio) {
    // Try to play immediately
    var playPromise = audio.play();
    if (playPromise !== undefined) {
      playPromise.catch(function(error) {
        // Autoplay was prevented, set up click listener
        console.log('Autoplay prevented, waiting for user interaction');
      });
    }
  }
});

// Also try to play on any user interaction
window.addEventListener('click', function playMusicOnce() {
  var audio = document.getElementById('birthday-music');
  if (audio && audio.paused) {
    audio.play().catch(function(error) {
      console.log('Could not play audio:', error);
    });
  }
  // Don't remove the listener, keep it for future interactions
});

// Try to play on touch events too
window.addEventListener('touchstart', function() {
  var audio = document.getElementById('birthday-music');
  if (audio && audio.paused) {
    audio.play().catch(function(error) {
      console.log('Could not play audio:', error);
    });
  }
}, { passive: true });
</script>
    <div class="game-container">
        <div class="game-title">üö™ TSP testy 2.0</div>
        <div class="game-subtitle">Spl≈à TSP test pro unik z tehto miestnosti a odomkni sushi!</div>
        
        <div class="progress-indicator" id="progress-indicator">√öloha 1 z 3</div>
        
        <div class="room-container">
            <div class="room-description" id="room-description">
                Vitaj na TSP testoch! Mus√≠≈° vyrie≈°i≈• 3 z√°hadn√© h√°danky a z√≠ska≈• aspo≈à 90 percentil, aby si uspela!
            </div>
            
            <!-- Puzzle 1 -->
            <div class="puzzle-step active" id="puzzle-1">
                <div class="puzzle-area">
                    <div class="puzzle-title">√öloha 1: ƒå√≠seln√° postupnos≈•</div>
                    <div style="margin-bottom: 15px; color: #7a5c1b;">
                        Ak√© ƒç√≠slo nasleduje v postupnosti: 2, 4, 8, 16, __?
                    </div>
                    <input type="text" class="puzzle-input" id="puzzle-1-input" placeholder="Zadaj svoju odpoveƒè..." autocomplete="off">
                    <button class="submit-btn" id="submit-1">Skontrolova≈•</button>
                    <button class="hint-btn" id="hint-1">üí° N√°poveda</button>
                    <div class="hint-text" id="hint-1-text">
                        32 vole
                    </div>
                </div>
            </div>
            
            <!-- Puzzle 2 -->
            <div class="puzzle-step" id="puzzle-2">
                <div class="puzzle-area">
                    <div class="puzzle-title">√öloha 2: Slovn√° h√°danka</div>
                    <div style="margin-bottom: 15px; color: #7a5c1b;">
                        ƒåo je to? M√° to listy, ale nie je to strom. M√° to korene, ale nie je to rastlina.
                    </div>
                    <input type="text" class="puzzle-input" id="puzzle-2-input" placeholder="Zadaj svoju odpoveƒè..." autocomplete="off">
                    <button class="submit-btn" id="submit-2">Skontrolova≈•</button>
                    <button class="hint-btn" id="hint-2">üí° N√°poveda</button>
                    <div class="hint-text" id="hint-2-text">
                        jakoo kniha je to vole
                    </div>
                </div>
            </div>
            
            <!-- Puzzle 3 -->
            <div class="puzzle-step" id="puzzle-3">
                <div class="puzzle-area">
                    <div class="puzzle-title">√öloha 3: Logick√° √∫loha</div>
                    <div style="margin-bottom: 15px; color: #7a5c1b;">
                        Ak m√°≈° 3 ovce a zje≈° 2, koƒæko ti zostane?
                    </div>
                    <input type="text" class="puzzle-input" id="puzzle-3-input" placeholder="Zadaj svoju odpoveƒè..." autocomplete="off">
                    <button class="submit-btn" id="submit-3">Skontrolova≈•</button>
                    <button class="hint-btn" id="hint-3">üí° N√°poveda</button>
                    <div class="hint-text" id="hint-3-text">
                        Nepotrebujes.. sak si ze Slovenska
                    </div>
                </div>
            </div>
            
            <div class="feedback" id="feedback"></div>
        </div>
        
        <div class="completed-message" id="completed-message">
            ‚úÖ V√Ωborne! √öspe≈°ne si unikla z TSP testov! Sushi je teraz odomknut√©.
        </div>
        
        <a href="menu.html" class="back-btn">‚Üê Sp√§≈• do menu</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentPuzzle = 1;
            const totalPuzzles = 3;
            
            const progressIndicator = document.getElementById('progress-indicator');
            const roomDescription = document.getElementById('room-description');
            const feedback = document.getElementById('feedback');
            
            // Puzzle answers (case insensitive)
            const answers = {
                1: ['32', 'tridsa≈•dva'],
                2: ['kniha', 'book'],
                3: ['1', 'jedna', 'jedno']
            };
            
            // Check if already completed
            if (localStorage.getItem('minigame_sushi') === 'completed') {
                document.getElementById('completed-message').style.display = 'block';
                // Do not hide puzzles, allow replay
            }
            
            function updateProgress() {
                progressIndicator.textContent = `√öloha ${currentPuzzle} z ${totalPuzzles}`;
            }
            
            function showPuzzle(puzzleNum) {
                // Hide all puzzles
                document.querySelectorAll('.puzzle-step').forEach(p => {
                    p.classList.remove('active');
                });
                
                // Show current puzzle
                document.getElementById(`puzzle-${puzzleNum}`).classList.add('active');
                
                // Clear input and feedback
                document.getElementById(`puzzle-${puzzleNum}-input`).value = '';
                feedback.style.display = 'none';
                
                // Hide all hints
                document.querySelectorAll('.hint-text').forEach(h => h.style.display = 'none');
                
                // Focus on input
                document.getElementById(`puzzle-${puzzleNum}-input`).focus();
                
                updateProgress();
            }
            
            function checkAnswer(puzzleNum, userAnswer) {
                const correctAnswers = answers[puzzleNum];
                const isCorrect = correctAnswers.some(answer => 
                    userAnswer.toLowerCase().trim() === answer.toLowerCase()
                );
                
                if (isCorrect) {
                    feedback.textContent = '‚úÖ Dob≈ôe vole!';
                    feedback.className = 'feedback correct';
                    feedback.style.display = 'block';
                    
                    // Move to next puzzle or complete
                    setTimeout(() => {
                        if (puzzleNum < totalPuzzles) {
                            currentPuzzle = puzzleNum + 1;
                            showPuzzle(currentPuzzle);
                        } else {
                            // Game completed
                            localStorage.setItem('minigame_sushi', 'completed');
                            document.getElementById('completed-message').style.display = 'block';
                            document.querySelectorAll('.puzzle-step').forEach(p => {
                                p.style.display = 'none';
                            });
                        }
                    }, 1500);
                } else {
                    feedback.textContent = '‚ùå Nespr√°vne. Sk√∫s to znova!';
                    feedback.className = 'feedback incorrect';
                    feedback.style.display = 'block';
                    
                    // Clear input for retry
                    document.getElementById(`puzzle-${puzzleNum}-input`).value = '';
                    document.getElementById(`puzzle-${puzzleNum}-input`).focus();
                }
            }
            
            // Set up submit button listeners
            for (let i = 1; i <= totalPuzzles; i++) {
                const submitBtn = document.getElementById(`submit-${i}`);
                const input = document.getElementById(`puzzle-${i}-input`);
                
                submitBtn.addEventListener('click', function() {
                    const userAnswer = input.value;
                    if (userAnswer.trim()) {
                        checkAnswer(i, userAnswer);
                    }
                });
                
                // Enter key support
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const userAnswer = this.value;
                        if (userAnswer.trim()) {
                            checkAnswer(i, userAnswer);
                        }
                    }
                });
            }
            
            // Set up hint button listeners
            for (let i = 1; i <= totalPuzzles; i++) {
                const hintBtn = document.getElementById(`hint-${i}`);
                const hintText = document.getElementById(`hint-${i}-text`);
                
                hintBtn.addEventListener('click', function() {
                    if (hintText.style.display === 'none' || !hintText.style.display) {
                        hintText.style.display = 'block';
                        hintBtn.textContent = 'üôà Skry≈• n√°povedu';
                    } else {
                        hintText.style.display = 'none';
                        hintBtn.textContent = 'üí° N√°poveda';
                    }
                });
            }
            
            // Initialize first puzzle
            updateProgress();
        });
    </script>
</body>
</html> 